\doxysection{src/main.cpp File Reference}
\hypertarget{main_8cpp}{}\label{main_8cpp}\index{src/main.cpp@{src/main.cpp}}
{\ttfamily \#include $<$Arduino.\+h$>$}\newline
{\ttfamily \#include $<$ESP32\+Encoder.\+h$>$}\newline
{\ttfamily \#include $<$Wire.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+Sensor.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+BNO055.\+h$>$}\newline
{\ttfamily \#include $<$cmath$>$}\newline
{\ttfamily \#include $<$Web\+Server.\+h$>$}\newline
{\ttfamily \#include "{}ADC128\+D818.\+h"{}}\newline
{\ttfamily \#include "{}PCA9956.\+h"{}}\newline
{\ttfamily \#include "{}Print\+Stream.\+h"{}}\newline
{\ttfamily \#include "{}IMU.\+h"{}}\newline
{\ttfamily \#include "{}MOTOR.\+h"{}}\newline
{\ttfamily \#include "{}ENCODER.\+h"{}}\newline
{\ttfamily \#include "{}EITwebhost.\+h"{}}\newline
{\ttfamily \#include "{}CD74\+HC4067\+SM.\+h"{}}\newline
{\ttfamily \#include "{}shares.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{main_8cpp_acb8d9e1ab8f1d0bc2abfa0eab6a7e706}\label{main_8cpp_acb8d9e1ab8f1d0bc2abfa0eab6a7e706} 
Share$<$ bool $>$ {\bfseries initialize\+VFLG} ("{}Measure V0"{})
\item 
\Hypertarget{main_8cpp_adb3985c4e0dc89bde6f73ad5152e78e4}\label{main_8cpp_adb3985c4e0dc89bde6f73ad5152e78e4} 
Share$<$ bool $>$ {\bfseries read\+VFLG} ("{}Read V"{})
\item 
\Hypertarget{main_8cpp_a04161a0333e46749f1310cdaf6c4ff1c}\label{main_8cpp_a04161a0333e46749f1310cdaf6c4ff1c} 
Share$<$ float $>$ {\bfseries x\+Bar} ("{}X Centroid"{})
\item 
\Hypertarget{main_8cpp_ac737158b9185276c9ce848c453128b84}\label{main_8cpp_ac737158b9185276c9ce848c453128b84} 
Share$<$ float $>$ {\bfseries y\+Bar} ("{}Y Centroid"{})
\item 
\Hypertarget{main_8cpp_a6e84d191593b8e526ada135e8e26edf5}\label{main_8cpp_a6e84d191593b8e526ada135e8e26edf5} 
Share$<$ bool $>$ {\bfseries data\+Available} ("{}Publish Flag"{})
\item 
void \mbox{\hyperlink{main_8cpp_af65c7f4495d4dc7c29d355d2d3871be4}{task\+\_\+\+Read\+Material}} (void \texorpdfstring{$\ast$}{*}p\+\_\+params)
\begin{DoxyCompactList}\small\item\em Task to handle cycling through the pins to take EIT voltage readings. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a0600249a0fd5d92a5fed83010c329fe3}{task\+\_\+control\+Motors}} (void \texorpdfstring{$\ast$}{*}parameter)
\begin{DoxyCompactList}\small\item\em Task to handle controlling the table position using an IMU and two motors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a577f28c6d870b5b9f1c4510d8195094a}{task\+\_\+webserver}} (void \texorpdfstring{$\ast$}{*}p\+\_\+params)
\begin{DoxyCompactList}\small\item\em Task to handle the webpage for user interfacing. \end{DoxyCompactList}\item 
\Hypertarget{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}\label{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d} 
void {\bfseries setup} ()
\item 
\Hypertarget{main_8cpp_afe461d27b9c48d5921c00d521181f12f}\label{main_8cpp_afe461d27b9c48d5921c00d521181f12f} 
void {\bfseries loop} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{main_8cpp_a9e384041fab2b2e8797505c609b8d99c}\label{main_8cpp_a9e384041fab2b2e8797505c609b8d99c} 
const uint8\+\_\+t {\bfseries s0\+\_\+\+PIN} = 26
\item 
\Hypertarget{main_8cpp_aee5c3166ce3fa80f79805587f049c8c4}\label{main_8cpp_aee5c3166ce3fa80f79805587f049c8c4} 
const uint8\+\_\+t {\bfseries s1\+\_\+\+PIN} = 25
\item 
\Hypertarget{main_8cpp_a02c801e8ca7815dec62bf55ca86512bc}\label{main_8cpp_a02c801e8ca7815dec62bf55ca86512bc} 
const uint8\+\_\+t {\bfseries s2\+\_\+\+PIN} = 33
\item 
\Hypertarget{main_8cpp_a33f0388f0631792d35e717cc687e6051}\label{main_8cpp_a33f0388f0631792d35e717cc687e6051} 
const uint8\+\_\+t {\bfseries s3\+\_\+\+PIN} = 32
\item 
\Hypertarget{main_8cpp_a3323d05cd41da7f205db662a3e8c0f59}\label{main_8cpp_a3323d05cd41da7f205db662a3e8c0f59} 
const uint8\+\_\+t {\bfseries Multi\+Enable\+\_\+\+PIN} = 35
\item 
\Hypertarget{main_8cpp_a9eb336ce22cd3b5df6e7b5c7df0460a3}\label{main_8cpp_a9eb336ce22cd3b5df6e7b5c7df0460a3} 
const uint8\+\_\+t {\bfseries ADC\+\_\+1\+ADDRESS} = 0x1D
\item 
\Hypertarget{main_8cpp_a41a404f2f5b85d9ddfc16560b818ec46}\label{main_8cpp_a41a404f2f5b85d9ddfc16560b818ec46} 
const uint8\+\_\+t {\bfseries ADC\+\_\+2\+ADDRESS} = 0x1F
\item 
\Hypertarget{main_8cpp_a24dd1f95a4290b15c52e8bc664bc7902}\label{main_8cpp_a24dd1f95a4290b15c52e8bc664bc7902} 
const uint8\+\_\+t {\bfseries PCA9956\+\_\+\+ADDRESS} = 0x01
\item 
\Hypertarget{main_8cpp_af7a1a90c51a823bdd750d7dfd4418853}\label{main_8cpp_af7a1a90c51a823bdd750d7dfd4418853} 
PCA9956 Curr\+Ctrl \& {\bfseries Wire}
\item 
\Hypertarget{main_8cpp_ae127ca0dd941de03bd8996e475e56b6c}\label{main_8cpp_ae127ca0dd941de03bd8996e475e56b6c} 
uint8\+\_\+t {\bfseries n\+Sleep\+Pin} = 02
\item 
\Hypertarget{main_8cpp_ae6c23a418fe55e82bd865a8e28b288b6}\label{main_8cpp_ae6c23a418fe55e82bd865a8e28b288b6} 
uint8\+\_\+t {\bfseries motor\+XPin1} = 19
\item 
\Hypertarget{main_8cpp_a503e5959872082ff62252a26bdf3fe99}\label{main_8cpp_a503e5959872082ff62252a26bdf3fe99} 
uint8\+\_\+t {\bfseries motor\+XPin2} = 18
\item 
\Hypertarget{main_8cpp_ab77cd3b2d61bdea0601f5350abcf71d5}\label{main_8cpp_ab77cd3b2d61bdea0601f5350abcf71d5} 
uint8\+\_\+t {\bfseries motor\+YPin1} = 17
\item 
\Hypertarget{main_8cpp_a8f51ad3c525971da3feea5c823acf32e}\label{main_8cpp_a8f51ad3c525971da3feea5c823acf32e} 
uint8\+\_\+t {\bfseries motor\+YPin2} = 16
\item 
\Hypertarget{main_8cpp_a725fa6b340030a320096ff043a24a283}\label{main_8cpp_a725fa6b340030a320096ff043a24a283} 
ESP32\+Encoder {\bfseries encoderX}
\item 
\Hypertarget{main_8cpp_ad2f255b53647f679fe6141a5914fa40c}\label{main_8cpp_ad2f255b53647f679fe6141a5914fa40c} 
ESP32\+Encoder {\bfseries encoderY}
\item 
\Hypertarget{main_8cpp_ae77c28be56bf5e9e5aa6b8ff1a554b20}\label{main_8cpp_ae77c28be56bf5e9e5aa6b8ff1a554b20} 
float {\bfseries publish} \mbox{[}208\mbox{]} = \{0\}
\item 
\Hypertarget{main_8cpp_a9610be4c840b076d78500f00dcc02f21}\label{main_8cpp_a9610be4c840b076d78500f00dcc02f21} 
Semaphore\+Handle\+\_\+t {\bfseries twi\+Mutex}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This project was created to run the soft-\/sensor activated balancing platform as the final project of Cal Poly SLO Fall ME 507 class. \begin{DoxyAuthor}{Author}
Jake Rowen 

Setting-\/\+Dawn 

Ethan Siahpush 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
2.\+0.\+0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2025-\/Dec-\/09 
\end{DoxyDate}


\label{doc-func-members}
\Hypertarget{main_8cpp_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{main_8cpp_a0600249a0fd5d92a5fed83010c329fe3}\index{main.cpp@{main.cpp}!task\_controlMotors@{task\_controlMotors}}
\index{task\_controlMotors@{task\_controlMotors}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{task\_controlMotors()}{task\_controlMotors()}}
{\footnotesize\ttfamily \label{main_8cpp_a0600249a0fd5d92a5fed83010c329fe3} 
void task\+\_\+control\+Motors (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{parameter}{}\end{DoxyParamCaption})}



Task to handle controlling the table position using an IMU and two motors. 

Has PID control on both motors to attempt to reach the desired setpoint and measured by a BNO055A IMU. 
\begin{DoxyParams}{Parameters}
{\em p\+\_\+params} & void\texorpdfstring{$\ast$}{*}, unused. \\
\hline
\end{DoxyParams}
\Hypertarget{main_8cpp_af65c7f4495d4dc7c29d355d2d3871be4}\index{main.cpp@{main.cpp}!task\_ReadMaterial@{task\_ReadMaterial}}
\index{task\_ReadMaterial@{task\_ReadMaterial}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{task\_ReadMaterial()}{task\_ReadMaterial()}}
{\footnotesize\ttfamily \label{main_8cpp_af65c7f4495d4dc7c29d355d2d3871be4} 
void task\+\_\+\+Read\+Material (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{p\+\_\+params}{}\end{DoxyParamCaption})}



Task to handle cycling through the pins to take EIT voltage readings. 

First waits for initialization of twi communication to complete. Then each round has one channel with an applied current, one grounded, and 14 others. ADCs read all adc channels, discards the two non-\/read channels, finds the deltaV between appropriate pins and stores all values in the resulting array into a global array after lowering the data\+Available flag. 
\begin{DoxyParams}{Parameters}
{\em p\+\_\+params} & void\texorpdfstring{$\ast$}{*}, unused. \\
\hline
\end{DoxyParams}
\Hypertarget{main_8cpp_a577f28c6d870b5b9f1c4510d8195094a}\index{main.cpp@{main.cpp}!task\_webserver@{task\_webserver}}
\index{task\_webserver@{task\_webserver}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{task\_webserver()}{task\_webserver()}}
{\footnotesize\ttfamily \label{main_8cpp_a577f28c6d870b5b9f1c4510d8195094a} 
void task\+\_\+webserver (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{p\+\_\+params}{}\end{DoxyParamCaption})}



Task to handle the webpage for user interfacing. 

publishes all 208 datapoints used for 1 measurement and some flags used by an external python program to know whether to initialize a base value or make appropriate calculations. Additionally, uses args on the webpage to allow the user or external python program to set a desired table position. 
\begin{DoxyParams}{Parameters}
{\em p\+\_\+params} & void\texorpdfstring{$\ast$}{*}, unused. \\
\hline
\end{DoxyParams}
